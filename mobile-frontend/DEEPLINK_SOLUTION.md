# Решение проблемы Deeplink для родителей с одним студентом

## Проблемы
1. **HTTPS deeplink не работает** (а jduapp-preview работает)
2. **Лишняя страница в навигации** для одного студента (показывается "назад к студентам", потом исчезает)

## Решение

### Подход
Вместо сложной автонавигации, используем простую логику:
- **Всегда показываем список студентов** (убрали автонавигацию)
- **Умная обработка deeplink** для случая с одним студентом
- **Единая логика навигации** для всех типов ссылок

### 1. Упрощён `native-intent.ts`
- Убрана сложная логика `getSmartNavigationPath()`
- Добавлена `getNavigationPathForSingleStudent()` для обработки случая с одним студентом
- Простая логика: если один студент и путь "/" → перенаправляем на студента

### 2. Упрощён `_layout.tsx`
- Убрана сложная логика с разными схемами
- Единая логика навигации для всех deeplink
- Увеличены задержки для стабильности (1500ms)
- Консистентная обработка message deeplink

### 3. Отключена автонавигация в `StudentSelector.tsx`
- Убрана автонавигация для одного студента
- Решает проблему с лишней страницей в навигации
- Всегда показываем список студентов

### 4. Оставлен `student-context.tsx`
- Сохранение метаданных для deeplink logic
- Работает в онлайн и оффлайн режимах

## Логика работы

### Все случаи (1 или N студентов):
- **Home deeplink** → Список студентов (если 1 студент → умная логика перенаправит)
- **Student deeplink** → Страница студента
- **Message deeplink** → Student page → Message page (с правильной навигацией)

### Ключевые изменения:
1. ✅ Убрана автонавигация (решает проблему лишней страницы)
2. ✅ Единая логика для HTTPS и dev схем (решает проблему HTTPS)
3. ✅ Простая и надёжная навигация
4. ✅ Правильная история навигации
5. ✅ Увеличены задержки для стабильности

## Результат:
- **jduapp-preview**: работает как раньше
- **HTTPS deeplink**: теперь работает так же хорошо  
- **Один студент**: нет лишней страницы, правильная навигация
- **Множественные студенты**: работает как раньше
